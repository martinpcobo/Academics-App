{"ast":null,"code":"import _asyncToGenerator from \"/Users/martin.perez.cobo/Documents/Repositories/Academics-App/academics-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventEmitter } from '@angular/core';\nimport AuthenticatorService from \"../../../../../services/AuthenticatorService\";\nimport AuthenticationService from \"../../../../../services/AuthenticationService\";\nimport { AuthenticatorDialogComponent } from \"../authenticator-dialog/authenticator-dialog.component\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"@angular/material/icon\";\nimport * as i3 from \"@angular/material/button\";\nimport * as i4 from \"@angular/material/card\";\nimport * as i5 from \"@angular/material/menu\";\nexport class AuthenticatorComponent {\n  constructor(dialog, authenticator_service, authentication_service) {\n    this.dialog = dialog;\n    this.authenticator_service = authenticator_service;\n    this.authentication_service = authentication_service;\n    this.authenticator = null;\n    this.refreshAuthenticators = new EventEmitter();\n    this.user = null;\n  }\n  ngOnInit() {\n    this.user = this.authentication_service.getUser();\n    this.authentication_service.getUserObserver().subscribe({\n      next: new_user => {\n        this.user = new_user;\n      },\n      error: error => {\n        this.user = null;\n      }\n    });\n  }\n  handleAuthenticatorNameChange() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const dialogRef = _this.dialog.open(AuthenticatorDialogComponent, {\n        data: {\n          title: \"New Passkey name\"\n        }\n      });\n      dialogRef.afterClosed().subscribe( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (result) {\n          if (!result) return;\n          let user_id = _this.user?.getIdentifier();\n          if (_this.user && _this.authenticator && user_id) {\n            yield _this.authenticator_service.modifyAuthenticatorName(_this.authenticator.getIdentifier(), user_id, result.toString());\n            _this.refreshAuthenticators.emit(null);\n          } else {\n            console.log(\"Could not find the Authenticator to modify or the User who owns it.\");\n          }\n        });\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n  handleAuthenticatorDelete() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      let user_id = _this2.user?.getIdentifier();\n      if (_this2.authenticator && _this2.user && user_id) {\n        yield _this2.authenticator_service.removeAuthenticator(_this2.authenticator.getIdentifier(), user_id);\n        _this2.refreshAuthenticators.emit(null);\n      } else {\n        console.log(\"Failed to delete authenticator!\");\n      }\n    })();\n  }\n  static {\n    this.ɵfac = function AuthenticatorComponent_Factory(t) {\n      return new (t || AuthenticatorComponent)(i0.ɵɵdirectiveInject(i1.MatDialog), i0.ɵɵdirectiveInject(AuthenticatorService), i0.ɵɵdirectiveInject(AuthenticationService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AuthenticatorComponent,\n      selectors: [[\"app-authenticator\"]],\n      inputs: {\n        authenticator: \"authenticator\"\n      },\n      outputs: {\n        refreshAuthenticators: \"refreshAuthenticators\"\n      },\n      decls: 19,\n      vars: 2,\n      consts: [[1, \"authenticator\"], [\"mat-icon-button\", \"\", \"aria-label\", \"Menu of options for authenticator.\", 3, \"matMenuTriggerFor\"], [\"authenticator_menu\", \"matMenu\"], [\"mat-menu-item\", \"\", 3, \"click\"]],\n      template: function AuthenticatorComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"mat-card\")(1, \"div\", 0)(2, \"span\");\n          i0.ɵɵtext(3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"button\", 1)(5, \"mat-icon\");\n          i0.ɵɵtext(6, \"more_vert\");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(7, \"mat-menu\", null, 2)(9, \"button\", 3);\n          i0.ɵɵlistener(\"click\", function AuthenticatorComponent_Template_button_click_9_listener() {\n            return ctx.handleAuthenticatorDelete();\n          });\n          i0.ɵɵelementStart(10, \"mat-icon\");\n          i0.ɵɵtext(11, \"delete\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"span\");\n          i0.ɵɵtext(13, \"Delete\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(14, \"button\", 3);\n          i0.ɵɵlistener(\"click\", function AuthenticatorComponent_Template_button_click_14_listener() {\n            return ctx.handleAuthenticatorNameChange();\n          });\n          i0.ɵɵelementStart(15, \"mat-icon\");\n          i0.ɵɵtext(16, \"edit\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"span\");\n          i0.ɵɵtext(18, \"Edit name\");\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          const _r0 = i0.ɵɵreference(8);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate((ctx.authenticator == null ? null : ctx.authenticator.getName()) ? ctx.authenticator == null ? null : ctx.authenticator.getName() : \"No name\");\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"matMenuTriggerFor\", _r0);\n        }\n      },\n      dependencies: [i2.MatIcon, i3.MatIconButton, i4.MatCard, i5.MatMenu, i5.MatMenuItem, i5.MatMenuTrigger],\n      styles: [\".authenticator[_ngcontent-%COMP%] {\\n  display: grid;\\n  grid-template-columns: 1fr max-content;\\n  column-gap: 0.5rem;\\n  justify-content: flex-start;\\n  align-items: center;\\n  padding: 0.5rem 1rem;\\n}\\n.authenticator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n  font-size: 1rem;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbW9kdWxlcy9kYXNoYm9hcmQvY29tcG9uZW50cy9wcm9maWxlL2F1dGhlbnRpY2F0b3IvYXV0aGVudGljYXRvci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7RUFDQSxzQ0FBQTtFQUVBLGtCQUFBO0VBRUEsMkJBQUE7RUFDQSxtQkFBQTtFQUVBLG9CQUFBO0FBRkY7QUFJRTtFQUNFLGVBQUE7QUFGSiIsInNvdXJjZXNDb250ZW50IjpbIi5hdXRoZW50aWNhdG9yIHtcbiAgZGlzcGxheTogZ3JpZDtcbiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWF4LWNvbnRlbnQ7XG5cbiAgY29sdW1uLWdhcDogLjVyZW07XG5cbiAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuXG4gIHBhZGRpbmc6IC41cmVtIDFyZW07XG5cbiAgc3BhbiB7XG4gICAgZm9udC1zaXplOiAxcmVtO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"names":["EventEmitter","AuthenticatorService","AuthenticationService","AuthenticatorDialogComponent","AuthenticatorComponent","constructor","dialog","authenticator_service","authentication_service","authenticator","refreshAuthenticators","user","ngOnInit","getUser","getUserObserver","subscribe","next","new_user","error","handleAuthenticatorNameChange","_this","_asyncToGenerator","dialogRef","open","data","title","afterClosed","_ref","result","user_id","getIdentifier","modifyAuthenticatorName","toString","emit","console","log","_x","apply","arguments","handleAuthenticatorDelete","_this2","removeAuthenticator","i0","ɵɵdirectiveInject","i1","MatDialog","selectors","inputs","outputs","decls","vars","consts","template","AuthenticatorComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","AuthenticatorComponent_Template_button_click_9_listener","AuthenticatorComponent_Template_button_click_14_listener","ɵɵadvance","ɵɵtextInterpolate","getName","ɵɵproperty","_r0"],"sources":["/Users/martin.perez.cobo/Documents/Repositories/Academics-App/academics-frontend/src/app/modules/dashboard/components/profile/authenticator/authenticator.component.ts","/Users/martin.perez.cobo/Documents/Repositories/Academics-App/academics-frontend/src/app/modules/dashboard/components/profile/authenticator/authenticator.component.html"],"sourcesContent":["import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\nimport Authenticator from \"../../../../../../models/Authenticator\";\nimport AuthenticatorService from \"../../../../../services/AuthenticatorService\";\nimport AuthenticationService from \"../../../../../services/AuthenticationService\";\nimport User from \"../../../../../../models/User\";\nimport {AuthenticatorDialogComponent} from \"../authenticator-dialog/authenticator-dialog.component\";\nimport {MatDialog, MatDialogRef} from \"@angular/material/dialog\";\n\n@Component({\n  selector: 'app-authenticator',\n  templateUrl: './authenticator.component.html',\n  styleUrls: ['./authenticator.component.scss']\n})\nexport class AuthenticatorComponent implements OnInit {\n  @Input()\n  public authenticator: Authenticator | null = null;\n  @Output()\n  public refreshAuthenticators: EventEmitter<null> = new EventEmitter<null>();\n\n  private user: User | null = null\n\n  constructor(\n    public dialog: MatDialog,\n    private authenticator_service: AuthenticatorService,\n    private authentication_service: AuthenticationService\n  ) {\n  }\n\n  ngOnInit() {\n    this.user = this.authentication_service.getUser();\n\n    this.authentication_service.getUserObserver().subscribe({\n      next: (new_user: User | null) => {\n        this.user = new_user;\n      },\n      error: (error) => {\n        this.user = null;\n      },\n    });\n  }\n\n  async handleAuthenticatorNameChange() {\n    const dialogRef: MatDialogRef<AuthenticatorDialogComponent> = this.dialog.open(AuthenticatorDialogComponent, {\n      data: {\n        title: \"New Passkey name\",\n      }\n    });\n\n    dialogRef.afterClosed().subscribe(async (result) => {\n      if (!result) return;\n\n      let user_id: String | undefined = this.user?.getIdentifier();\n\n      if (this.user && this.authenticator && user_id) {\n        await this.authenticator_service.modifyAuthenticatorName(this.authenticator.getIdentifier(), user_id, result.toString());\n        this.refreshAuthenticators.emit(null);\n      } else {\n        console.log(\"Could not find the Authenticator to modify or the User who owns it.\");\n      }\n    })\n  }\n\n  async handleAuthenticatorDelete() {\n    let user_id: String | undefined = this.user?.getIdentifier();\n    if (this.authenticator && this.user && user_id) {\n      await this.authenticator_service.removeAuthenticator(this.authenticator.getIdentifier(), user_id)\n\n      this.refreshAuthenticators.emit(null);\n    } else {\n      console.log(\"Failed to delete authenticator!\");\n    }\n  }\n}\n","<mat-card>\n  <div class=\"authenticator\">\n    <span>{{this.authenticator?.getName() ? this.authenticator?.getName() : 'No name'}}</span>\n    <button mat-icon-button [matMenuTriggerFor]=\"authenticator_menu\" aria-label=\"Menu of options for authenticator.\">\n      <mat-icon>more_vert</mat-icon>\n    </button>\n  </div>\n</mat-card>\n\n<mat-menu #authenticator_menu=\"matMenu\">\n  <button mat-menu-item (click)=\"this.handleAuthenticatorDelete()\">\n    <mat-icon>delete</mat-icon>\n    <span>Delete</span>\n  </button>\n  <button mat-menu-item (click)=\"this.handleAuthenticatorNameChange()\">\n    <mat-icon>edit</mat-icon>\n    <span>Edit name</span>\n  </button>\n</mat-menu>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}